---
created: 2025-03-26T05:57:16+09:00
modified: 2025-03-26T05:57:24+09:00
---

# ì¥ê³ 

ë„¤, ë§ì”€í•˜ì‹  ë³´ì•ˆ ì¡°ê±´ì„ ê³ ë ¤í•´ì„œ ì•„ë˜ì™€ ê°™ì´ êµ¬ì¡°ë¥¼ ë³€ê²½í•˜ì—¬, **Djangoì—ì„œë§Œ ë‚´ë¶€(localhost)ë¡œ Streamlitì„ ì‹¤í–‰í•˜ê³ , ì™¸ë¶€ ì ‘ì†ì€ ë¬´ì¡°ê±´ Djangoë¥¼ í†µí•´ì„œë§Œ ê°€ëŠ¥í•˜ë„ë¡** ì„¤ê³„í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬ì„±í•˜ê² ìŠµë‹ˆë‹¤.

---

## ê°œìš” (ë³´ì•ˆ ê³ ë ¤)

- ì™¸ë¶€ì—ì„œ Streamlit ì§ì ‘ ì ‘ì† ë¶ˆê°€ëŠ¥
- Djangoì—ì„œë§Œ ë‚´ë¶€ë¡œ Streamlitì„ ì‹¤í–‰ (`localhost:í¬íŠ¸`ë¡œë§Œ ë°”ì¸ë”©)
- Djangoê°€ ì‚¬ìš©ì IPë¥¼ í™•ì¸ í›„, ë“±ë¡ëœ ì‚¬ìš©ìì— ëŒ€í•´ì„œë§Œ Streamlit ì‹¤í–‰ í›„ í”„ë¡ì‹œ í˜•íƒœë¡œ ì ‘ê·¼ í—ˆìš©
- ë¯¸ë“±ë¡ ì‚¬ìš©ìëŠ” ì ‘ê·¼ ì°¨ë‹¨

---

## ìµœì  êµ¬ì¡°

```
[ì‚¬ìš©ì] â†’ Django(IP ì²´í¬ ë° ì¸ì¦, í”„ë¡ì‹œ) â†’ Streamlit(localhostì—ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥)
```

---

## ì¥ê³  ëª¨ë“ˆ ìµœì‹  ì—…ë°ì´íŠ¸ ì½”ë“œ

### **1. Django `settings.py`**

```python
ADMIN_IPS = ['127.0.0.1', '192.168.1.100']
USER_IPS = ['192.168.1.101', '192.168.1.102']

STREAMLIT_PORTS = {
    '127.0.0.1': 8501,
    '192.168.1.100': 8502,
    '192.168.1.101': 8503,
    '192.168.1.102': 8504,
}

MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'frontend.middleware.IPAccessMiddleware',
]
```

---

### **2. Django `middleware.py`**

```python
from django.conf import settings
from django.http import HttpResponseRedirect

class IPAccessMiddleware:
    def __init__(self, get_response):
        self.get_response = get_response

    def __call__(self, request):
        user_ip = request.META.get('REMOTE_ADDR')

        if user_ip in settings.ADMIN_IPS:
            request.user_role = 'admin'
        elif user_ip in settings.USER_IPS:
            request.user_role = 'user'
        else:
            return HttpResponseRedirect('/unauthorized/')

        response = self.get_response(request)
        return response
```

---

### **3. Django View (`views.py`)**

```python
from django.shortcuts import render, redirect
import subprocess
import psutil
from django.conf import settings
import requests
from django.http import HttpResponse

def home(request):
    role = getattr(request, 'user_role', 'unregistered')
    return render(request, 'home.html', {'role': role})

def run_streamlit(port):
    # ì´ë¯¸ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸
    for proc in psutil.process_iter(attrs=['pid', 'name', 'cmdline']):
        if 'streamlit' in proc.info['name'].lower() and f'--server.port={port}' in ' '.join(proc.info['cmdline']):
            return  # ì´ë¯¸ ì‹¤í–‰ ì¤‘ì´ë©´ ë¬´ì‹œ

    # ë‚´ë¶€(localhost)ì—ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥í•œ Streamlit ì‹¤í–‰
    subprocess.Popen([
        'streamlit', 'run', 'src/main.py',
        f'--server.port={port}',
        '--server.address=127.0.0.1'  # ë¡œì»¬ì—ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥
    ])

def streamlit_proxy(request, path=''):
    user_ip = request.META.get('REMOTE_ADDR')
    port = settings.STREAMLIT_PORTS.get(user_ip)

    if not port:
        return redirect('/unauthorized/')

    run_streamlit(port)

    # Streamlit ì„œë²„ë¡œ ë‚´ë¶€ í”„ë¡ì‹œ ìš”ì²­
    streamlit_url = f'http://127.0.0.1:{port}/{path}'
    try:
        resp = requests.get(streamlit_url, params=request.GET, headers=request.headers, timeout=10)
        return HttpResponse(resp.content, status=resp.status_code, content_type=resp.headers['Content-Type'])
    except requests.exceptions.RequestException:
        return HttpResponse("Streamlit ì•± ì ‘ê·¼ ì‹¤íŒ¨", status=500)

def unauthorized(request):
    return render(request, 'unauthorized.html')
```

---

### **4. Django `urls.py`**

```python
from django.urls import path, re_path
from frontend import views

urlpatterns = [
    path('', views.home, name='home'),
    re_path(r'^app/(?P<path>.*)$', views.streamlit_proxy, name='streamlit_proxy'),
    path('unauthorized/', views.unauthorized, name='unauthorized'),
]
```

---

### **5. Templates**

### `home.html`

```html
<!DOCTYPE html>
<html>
<head>
    <title>5G Feature Manager</title>
</head>
<body>
  {% if role == 'admin' %}
    <h1>ê´€ë¦¬ì í˜ì´ì§€</h1>
    <p><a href="/app/">Streamlit ì•± ì‹¤í–‰ ë° ì ‘ì†</a></p>
    <p><a href="/admin/">ê´€ë¦¬ì í˜ì´ì§€</a></p>

  {% elif role == 'user' %}
    <h1>ì‚¬ìš©ì í˜ì´ì§€</h1>
    <p><a href="/app/">Streamlit ì•± ì‹¤í–‰ ë° ì ‘ì†</a></p>

  {% endif %}
</body>
</html>
```

### `unauthorized.html`

```html
<!DOCTYPE html>
<html>
<head>
    <title>ì ‘ê·¼ ì œí•œ</title>
</head>
<body>
  <h1>ğŸš« ì ‘ê·¼ ì œí•œ ğŸš«</h1>
  <p>ë“±ë¡ë˜ì§€ ì•Šì€ ì‚¬ìš©ìì…ë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.</p>
</body>
</html>
```

---

### **6. í•„ìˆ˜ Python íŒ¨í‚¤ì§€**

```bash
pip install django streamlit psutil requests
```

- `requests`: Djangoì—ì„œ Streamlitìœ¼ë¡œì˜ í”„ë¡ì‹œ í†µì‹ ì„ ìœ„í•´ í•„ìš”

---

### **7. ì‹¤í–‰ ë°©ë²•**

Django ì‹¤í–‰:

```bash
python manage.py runserver 0.0.0.0:8000
```

- ì‚¬ìš©ìëŠ” Django ì£¼ì†Œë¡œë§Œ ì ‘ì† (`http://server-ip:8000`)
- Streamlitì€ ì™¸ë¶€ ì ‘ê·¼ì´ ë¶ˆê°€ëŠ¥í•˜ê³  Djangoë¥¼ í†µí•´ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥

---

### **8. ë™ì‘ íë¦„**

- ì‚¬ìš©ìê°€ Djangoë¡œ ì ‘ì†í•˜ë©´ IPë¥¼ ì²´í¬í•˜ì—¬ ë“±ë¡ ì—¬ë¶€ íŒë‹¨
- ë“±ë¡ëœ IPì¸ ê²½ìš°, í•´ë‹¹ í¬íŠ¸ë¡œ Streamlit ì‹¤í–‰ í›„ ë‚´ë¶€ í”„ë¡ì‹œ ìš”ì²­
- ë¯¸ë“±ë¡ IPëŠ” ì ‘ê·¼ ì°¨ë‹¨ í˜ì´ì§€ë¡œ ì´ë™

ì˜ˆì‹œ ì‹œë‚˜ë¦¬ì˜¤:

| ì‚¬ìš©ì ìœ í˜• | IP | Streamlit í¬íŠ¸ | ì ‘ê·¼ ê°€ëŠ¥ ì—¬ë¶€ |
|---|---|---|---|
| ê´€ë¦¬ì | `127.0.0.1` | `8501` | âœ… ê°€ëŠ¥ |
| ì‚¬ìš©ì | `192.168.1.101` | `8503` | âœ… ê°€ëŠ¥ |
| ë¯¸ë“±ë¡ | `192.168.1.200` | ì—†ìŒ | âŒ ì ‘ê·¼ ì œí•œ |

---

### **9. ë³´ì•ˆì  ì¸¡ë©´**

- Streamlit ì•±ì€ `127.0.0.1`(localhost)ì—ì„œë§Œ ë°”ì¸ë”©ë˜ì–´ ë³´ì•ˆ ê°•í™”
- ì§ì ‘ ì™¸ë¶€ì—ì„œ Streamlit ì ‘ê·¼ ë¶ˆê°€ëŠ¥(ë³´ì•ˆíŒ€ ì¡°ê±´ ì¶©ì¡±)
- ëª¨ë“  ì™¸ë¶€ ìš”ì²­ì€ Djangoì—ì„œ IP ê¸°ë°˜ìœ¼ë¡œ ì¸ì¦ í›„ í—ˆìš© ì—¬ë¶€ ê²°ì •

---

ì´ ë°©ì‹ìœ¼ë¡œ êµ¬ì„±í•˜ë©´ ë³´ì•ˆ ë¬¸ì œë¥¼ ì™„ë²½íˆ í•´ê²°í•˜ë©´ì„œë„ Streamlit ì•±ì„ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¶”ê°€ì ì¸ ìš”êµ¬ì‚¬í•­ì´ë‚˜ ì§ˆë¬¸ ìˆìœ¼ì‹œë©´ í¸í•˜ê²Œ ì•Œë ¤ì£¼ì„¸ìš”!
