---
created: 2025-03-26T16:47:14+09:00
modified: 2025-03-26T16:47:28+09:00
---

# 2025-03-26-Django를 이용한 서버 부하 관리

아래는 Django를 이용한 서버 부하 관리에 대한 상세한 설명과 관리 방법입니다.

---

## **1. Django의 내장 개발 서버의 한계**

기본적으로 Django의 내장 개발 서버(`python manage.py runserver`)는 간단한 용도 및 테스트 환경을 위해 설계되었습니다.

- **특징 및 제한 사항**
  - 다중 요청 처리는 가능하지만, 기본적으로 **단일 쓰레드**에서 작동하므로 동시에 많은 요청을 처리하는 데는 한계가 있음
  - 최대 동시 사용자 5명 이내, 전체 사용자 20명 내외 수준에서는 성능상 큰 문제가 없음
  - 고성능이 요구되는 대규모 서비스에서는 적합하지 않음

---

## **2. 현재 환경 (파트너 사용 목적 기준)**

- 최대 **동시 사용자**: 5명
- 최대 전체 사용자: 20명
- 예상 요청 빈도: 중간~낮음 (분석 도구로 가끔씩 접근)
- 데이터 처리량: 중간 이하 (기본적인 데이터 시각화 및 비교 기능)

위와 같은 환경에서라면 **별도의 복잡한 세팅 없이** Django 기본 서버로도 안정적인 운영이 가능합니다.

---

## **3. Django 내장 서버로 부하 관리하기**

기본적으로는 별도의 설정 없이 자동 관리됩니다.

- **내장 서버 특성**
  - 동시 사용자가 적을 경우 자동으로 요청을 빠르게 처리하여 큰 지연이 발생하지 않음
  - 서버 리소스를 효율적으로 사용하기 위해, 오래 걸리는 작업(Streamlit 앱 로드 등)은 사전 프로세스로 처리하여 관리함
  - 현재 설계한 방식대로 IP 기반으로 개별 Streamlit 앱 프로세스를 분리 실행하면 자연스럽게 병목이 분산됨

### 권장 설정 (간단한 부하 관리 최적화)

Django에서 특별히 부하 관리에 필요한 별도 설정은 없지만, 아래의 기본 권장 사항을 지키면 성능이 안정화됩니다.

- 데이터베이스 접근을 최소화하거나 캐시(Cache)를 사용
- 무거운 계산이나 분석 작업은 Django가 아닌 Streamlit 앱 내부에서 수행
- 각 Streamlit 앱 인스턴스를 미리 분리하여 사용자별 프로세스로 제공하면 병목 현상을 예방할 수 있음

---

## **4. 내장 서버의 한계를 넘는 경우 (장기적으로 고려할 사항)**

사용자가 늘어나거나 서비스가 더 많은 리소스를 요구하게 된다면, 아래의 방법을 통해 Django 서버를 최적화할 수 있습니다.

### 방법 1: **Gunicorn (WSGI 서버)** - (추천)

- Gunicorn은 Django를 위한 안정적이고 가벼운 웹서버로, 멀티 프로세싱을 기본 지원하여 동시에 여러 요청을 효율적으로 처리합니다.

#### 설치 및 설정 방법

```bash
pip install gunicorn
```

**실행 예시** (윈도우는 WSL을 통해 사용):

```bash
gunicorn django_server.wsgi:application --bind 0.0.0.0:8000 --workers 4
```

- `--workers 4`: 동시에 4개의 요청을 병렬 처리 가능 (필요에 따라 늘릴 수 있음)

---

### 방법 2: **Apache 또는 Nginx를 통한 프록시 서버 구성** - (추천)

더 많은 요청을 처리하고 효율적인 정적 파일 관리 및 SSL 보안 지원 등을 원하면 Apache 또는 Nginx 웹 서버를 이용합니다.

**예시: Nginx 설정**

```nginx
server {
    listen 80;
    server_name your-server-ip;

    location / {
        proxy_pass http://127.0.0.1:8000;  # Django 서버 프록시 설정
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
```

이렇게 하면 Django 서버가 처리하는 부하를 효율적으로 관리할 수 있으며, 확장성과 보안성을 함께 높일 수 있습니다.

---

## **5. 서버 성능 모니터링 및 문제 진단 방법**

다음 도구를 사용하여 서버 부하 상태를 실시간으로 점검하세요:

- Windows 작업 관리자로 CPU/메모리 사용량 점검
- Django Debug Toolbar를 활용하여 쿼리 및 응답시간을 점검
- Streamlit의 실행 상태를 `psutil`을 통해 주기적으로 점검하여 과부하 여부를 판단

**예시 코드 (psutil을 활용한 간단 모니터링)**

```python
import psutil

# CPU 및 메모리 사용량 확인
print("CPU 사용률:", psutil.cpu_percent(interval=1), "%")
print("메모리 사용률:", psutil.virtual_memory().percent, "%")
```

---

## **6. 결론 (추천 운영 방식)**

| 현재 상황 (소규모) | 사용자 증가 (장기적 상황) |
|------------------|------------------------|
| Django 내장 서버 (단일 프로세스) | Gunicorn WSGI + Nginx 프록시 서버 |

- 현재 수준(동시 접속자 5명, 전체 20명 이하)에서는 **Django 기본 서버만으로 충분**합니다.
- 장기적으로 서비스가 커지고 사용자가 늘어나면 **Gunicorn 및 Nginx를 통한 프록시 서버 구성**으로 확장하세요.

---

위 내용을 참고하여 현재 운영환경에서의 부하 관리를 안정적으로 하시고, 장기적인 사용 증가 시 제시된 방식을 활용하여 확장성을 높일 수 있습니다. 추가적으로 필요한 사항이 있으시면 언제든지 알려주세요!
